---
page_type: sample
products:
- office-365
- office-outlook
languages:
- javascript
extensions:
  contentType: samples
  technologies:
  - Add-ins
  createdDate: 10/19/2017 1:01:24 PM
---
# Надстройка Outlook: Активация сообщений с действиями

В примере показано, как [активировать надстройку из сообщения с действиями](https://docs.microsoft.com/outlook/actionable-messages/invoke-add-in-from-actionable-message) и передать контекст инициализации надстройке.

## Запуск приложения

Для работы с этим примером требуется разместить включенные файлы на веб-сервере. Вы можете выбрать любой веб-сервер. Единственное требование заключается в том, что веб-сервер должен быть защищен действительным SSL-сертификатом. 

### Обновление манифеста

Перед загрузкой надстройки вы должны обновить [манифест](actionable-add-in.xml), чтобы заменить все экземпляры `localhost:8080` базовым URL-адресом сервера, на котором размещается надстройка.

### Установка надстройки

Следуйте инструкциями из статьи [Загрузка неопубликованных надстроек Outlook для тестирования](https://docs.microsoft.com/en-us/outlook/add-ins/sideload-outlook-add-ins-for-testing), чтобы загрузить неопубликованный файл `actionable-add-in.xml` для установки надстройки.

### Использование надстройки

Надстройка добавляет на ленту две кнопки при чтении сообщений электронной почты.

- **Отправить активацию надстройки**. Эта кнопка позволяет отправлять себе сообщения электронной почты с действиями с применением кнопок, вызывающих надстройку.
- **Просмотреть контекст инициализации**. Эта кнопка открывает область задач и отображает текущий контекст инициализации (при наличии).

> **Примечание.** Контекст инициализации присутствует только в том случае, если область задач вызвана из сообщения с действиями. Если вы открываете область задач с помощью кнопки ленты, появится сообщение о необходимости вызвать надстройку из сообщения.
>
> ![Снимок экрана: сообщение, отображаемое при активации надстройки вручную](readme-images/manual-activation.PNG)

1. Нажмите кнопку **Отправить активацию надстройки**. Откроется диалоговое окно для отправки сообщения: 

    ![Снимок экрана: диалоговое окно отправки сообщения](readme-images/send-message.PNG)
1. (Необязательно). Измените контекст инициализации.
1. Нажмите кнопку **Отправить сообщение**.
1. Когда сообщение поступит в папку "Входящие", откройте его.

    ![Снимок экрана: сообщение с действиями, отправленное надстройкой](readme-images/actionable-message.PNG)
1. Нажмите кнопку **Вызвать "просмотр контекста инициализации"**.
1. Откроется область задач надстройки с отображением контекста инициализации.

    ![Снимок экрана с открытой областью задач](readme-images/activated-taskpane.PNG)

### Использование установки по запросу для надстройки из Магазина

Чтобы узнать, как выполняется установка по запросу для надстроек из Магазина, можно использовать вторую кнопку в сообщении с действиями. Перед ее использованием, если у вас уже есть [Анализатор заголовков сообщений](https://appsource.microsoft.com/en-us/product/office/WA104005406), не забудьте удалить его.

Этот проект соответствует [Правилам поведения разработчиков открытого кода Майкрософт](https://opensource.microsoft.com/codeofconduct/). Дополнительные сведения см. в разделе [часто задаваемых вопросов о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).
